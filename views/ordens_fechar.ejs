<%- include("./partials/cabecalho") %>

<h1 class="page-title">
    <i class="fa-solid fa-lock"></i>
    Fechar Ordem de Serviço
</h1>

<div class="card form-card">

    <h2 style="color:var(--green-900); margin-bottom:12px;">
        OS #<%= os.id %> — <%= os.equipamento_nome %>
    </h2>

    <p><strong>Tipo:</strong> <%= os.tipo %></p>
    <p><strong>Descrição:</strong> <%= os.descricao %></p>

    <div style="margin:14px 0;">
      <strong>Status atual:</strong>
      <% if (os.status === 'Fechada') { %>
        <span class="tag verde-escuro">Fechada</span>
      <% } else if (os.status === 'Em Andamento') { %>
        <span class="tag cinza-escuro">Em Andamento</span>
      <% } else { %>
        <span class="tag cinza-claro">Aberta</span>
      <% } %>
    </div>

    <% if (os.status !== "Fechada") { %>

    <form action="/ordens/<%= os.id %>/fechar" method="POST" class="formulario">

        <div class="grupo">
            <label>Observação de fechamento</label>
            <textarea name="obs_fechamento" rows="4" required></textarea>
        </div>

        <div class="grupo">
            <label>Data de fechamento</label>
            <input type="date" name="data_fechamento" required>
        </div>

        <button class="btn btn-verde-claro btn-full">
            <i class="fa-solid fa-lock"></i>
            Fechar OS
        </button>
    </form>

    <% } else { %>
        <div class="alert-error">
            Esta OS já foi fechada.
        </div>
    <% } %>

</div>

<a href="/ordens" class="btn btn-cinza-escuro">
    ← Voltar
</a>

<%- include("./partials/rodape") %>

